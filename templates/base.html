<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            {% block title %}{{ config.title | default(value="Blog") }}{%
            endblock %}
        </title>

        <!-- Tailwind + Basecoat CSS -->
        <link rel="stylesheet" href="{{ get_url(path='css/style.css') }}" />

        <!-- KaTeX for math rendering -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

        {% block head %}{% endblock %}
    </head>
    <body class="min-h-screen bg-background text-foreground">
        <main>{% block content %}{% endblock %}</main>

        {% block footer %}{% endblock %}

        <!-- Basecoat JS for interactive components -->
        <script
            src="{{ get_url(path='js/basecoat/basecoat.min.js') }}"
            defer
        ></script>
        <!-- Custom tabs for panel-tabset -->
        <script src="{{ get_url(path='js/tabs.js') }}" defer></script>
        <script>
            (() => {
                try {
                    const stored = localStorage.getItem("themeMode");
                    if (
                        stored
                            ? stored === "dark"
                            : matchMedia("(prefers-color-scheme: dark)").matches
                    ) {
                        document.documentElement.classList.add("dark");
                    }
                } catch (_) {}

                const apply = (dark) => {
                    document.documentElement.classList.toggle("dark", dark);
                    try {
                        localStorage.setItem(
                            "themeMode",
                            dark ? "dark" : "light",
                        );
                    } catch (_) {}
                };

                document.addEventListener("basecoat:theme", (event) => {
                    const mode = event.detail?.mode;
                    apply(
                        mode === "dark"
                            ? true
                            : mode === "light"
                              ? false
                              : !document.documentElement.classList.contains(
                                    "dark",
                                ),
                    );
                });
            })();
        </script>
        <!-- KaTeX auto-render -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
            onload="renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ]
            });"></script>
        {% block scripts %}{% endblock %}
    </body>
</html>
